<!-- notification_settings.html -->
{% extends '../baseuser.html' %}

{% block title %}通知設定{% endblock %}

{% block content %}
<div class="notification-container">
    <h1>通知設定</h1>
    <div class="setting-item">
        <p>誰かがあなたの投稿に「いいね」したら通知する：</p>
        <button onclick="updateSetting('notify_likes', true)">ON</button>
        <button onclick="updateSetting('notify_likes', false)">OFF</button>
    </div>
    <div class="setting-item">
        <p>掲示板に新しいメニューが投稿されたら通知する：</p>
        <button onclick="updateSetting('notify_new_menu', true)">ON</button>
        <button onclick="updateSetting('notify_new_menu', false)">OFF</button>
    </div>
</div>

<script>
    function updateSetting(setting, value) {
        const csrfToken = '{{ csrf_token }}'; // CSRFトークンを挿入

        fetch('/update-notification-setting/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrfToken
            },
            body: JSON.stringify({ setting: setting, value: value })
        })
        .then(response => {
            if (response.ok) {
                alert('設定が更新されました');
            } else {
                alert('設定の更新に失敗しました');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('エラーが発生しました');
        });
    }
</script>
{% endblock %}
